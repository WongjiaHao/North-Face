<!--
 * @Author: Wenjiahao
 * @Date: 2022-08-29 20:39:16
 * @LastEditors: wenjiahao
 * @LastEditTime: 2022-09-06 21:16:57
 * @FilePath: \North-face\HTML\details.html
 * @Description: 
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../North-face/font/iconfont.css">
    <link rel="stylesheet" href="../../North-face/CSS/header/header.css">
    <link rel="stylesheet" href="../../North-face/CSS/footer/footer.css">
    <link rel="stylesheet" href="../CSS/details/detail.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <title>Document</title>
</head>

<body>
    <header></header>
    <main>
        <!-- <div class="INFO">
            <div class="w">
            <h4>服装-</h4>
            <div class="chooseGoods">
                <div class="left">
                    <img src="../images/f4-1.jpg" alt="">
                    <div class="mask"></div>
                </div>
                <div class="right">
                    <img src="../images/f4-1.jpg" alt="">
                </div>
                <div class="info">
                    <h3>
                        TheNorthFace北面短袖T恤男户外舒适透气秋季上新|7QUX
                    </h3>
                    <p class="info-title">服装-</p>
                    <div>
                        <div class="price">
                            <div class="up"><i>￥398.00</i></div>
                            <div class="down">
                                <p style="font-size:16px;">
                                    <img src="https://www.thenorthface.com.cn/themes/tnf2021/images/logov.png"
                                        style="vertical-align: middle;padding-right:8px;">
                                    <a target="_blank" href="/index.php/passport-login.html?type=fast" class="underth"
                                        style="font-size:16px;">加入探索通</a>
                                </p>
                            </div>
                        </div>
                        <div class="share">
                            <a href="#" class="remember">收藏该商品</a>
                            <p>分享至：
                                <span class="iconfont icon-weixin"><a href="#"></a></span>
                                <span class="iconfont icon-weibo1"><a href="#"></a></span>
                                <span class="iconfont icon-qq"><a href="#"></a></span>
                                <span class="iconfont icon-qqkongjian"><a href="#"></a></span>
                            </p>
                        </div>
                        <div class="colorBox">
                            <p>颜色 <span>黑色</span></p>
                            <img src="../images/like-5.jpg" alt="">
                        </div>
                        <div class="sizeBox">
                            <p>配件尺寸 <span>均码</span></p>
                            <span>均码</span>
                        </div>
                        <div class="count">
                            <p>数量</p>
                            <div>
                            <a href="#" class="reduce">-</a><span class="numbers">1</span><a href="#"
                                class="add">+</a>
                            </div>
                            </div>
                        <div class="op"><button class="buy">立即购买</button><button class="intoCart">加入购物车</button></div>
                    </div>
                </div>
            </div>
            <div class="detail"></div>
            </div>
        </div>
        <div class="bboard">
            <div class="w"><a href="">商品详情</a></div>
            
        </div>
        <div class="DETAIL">
            <div class="w">
                <p class="allPic">
                <img src="../images/d1.jpg" alt="">
                <img src="../images/d2.jpg" alt="">
                <img src="../images/d3.jpg" alt="">
                <img src="../images/d4.jpg" alt="">
                <img src="../images/d5.jpg" alt="">
                <img src="../images/d6.jpg" alt="">
                <img src="../images/d7.jpg" alt="">
                <img src="../images/d8.jpg" alt="">
                <img src="../images/d9.jpg" alt="">
                <img src="../images/d10.jpg" alt="">
            </p>
            </div>
        </div>

        <div class="like">
            <div class="w">
            <h2>猜你喜欢</h2>
            <ul>
                <li><a href="#">
                        <img src="../images/like-1.jpg" alt="">
                        <p>TheNorthFace北面短袖Polo男户外舒适透气上新|5B1O</p>
                        <span class="cont-money">¥398.00</span>
                        <span class="cost-line">¥398.00</span>
                    </a></li>
                <li><a href="#">
                        <img src="../images/like-2.jpg" alt="">
                        <p>【山夏Tee】TheNorthFace北面短袖Polo男户外速干吸湿排汗上新|5B1P</p>
                        <span class="cont-money">¥398.00</span>
                        <span class="cost-line">¥398.00</span>
                    </a></li>
                <li><a href="#">
                        <img src="../images/like-3.jpg" alt="">
                        <p>TheNorthFace北面短袖T恤通用款户外舒适透气春季上新|5JZT</p>
                        <span class="cont-money">¥348.00</span>
                        <span class="cost-line">¥348.00</span>
                    </a></li>
                <li><a href="#">
                        <img src="../images/like-4.jpg" alt="">
                        <p>TheNorthFace北面短袖T恤情侣款户外舒爽透气春季上新|7WDX</p>
                        <span class="cont-money">¥298.00</span>
                        <span class="cost-line">¥298.00</span>
                    </a></li>
                <li><a href="#">
                        <img src="../images/like-5.jpg" alt="">
                        <p>TheNorthFace北面短袖T恤情侣款户外舒爽透气春季上新|7WE1</p>
                        <span class="cont-money">¥348.00</span>
                        <span class="cost-line">¥348.00</span>
                    </a></li>
            </ul>
        </div>
        </div>  -->
    </main>
    <footer></footer>

    <script>
        $("header").load("../HTML/header.html");
        $("footer").load("../HTML/footer.html");
    </script>
     <script>
        var goodsId=location.search;
        // console.log(goodsId);
        var goodsInfo 
          if(!goodsId){
            alert('非法进入');
            location='./goodsList.html'
          }else{
            Id=goodsId.split('=')[1];
            $.ajax({
                url:'../PHP/details.php',
                type:'GET',
                async:false,
                data:{Id},
                success(res){
                    goodsInfo=eval('('+res+')');
                    // console.log(goodsInfo);
                    var str=`
                    <div class="INFO">
                            <div class="w">
                            <h4>服装-</h4>
                            <div class="chooseGoods">
                                <div class="left">
                                    <img src="${goodsInfo.goods_p1}" alt="">
                                    <div class="mask"></div>
                                </div>
                                <div class="right">
                                    <img src="${goodsInfo.goods_p1}" alt="">
                                </div>
                                <div class="info">
                                    <h3>
                                        ${goodsInfo.goods_t2}
                                    </h3>
                                    <p class="info-title">服装-</p>
                                    <div>
                                        <div class="price">
                                            <div class="up"><i>￥${parseInt(goodsInfo.goods_price).toFixed(2)}</i></div>
                                            <div class="down">
                                                <p style="font-size:16px;">
                                                    <img src="https://www.thenorthface.com.cn/themes/tnf2021/images/logov.png"
                                                        style="vertical-align: middle;padding-right:8px;">
                                                    <a target="_blank" href="/index.php/passport-login.html?type=fast" class="underth"
                                                        style="font-size:16px;">加入探索通</a>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="share">
                                            <a href="#" class="remember">收藏该商品</a>
                                            <p>分享至：
                                                <span class="iconfont icon-weixin"><a href="#"></a></span>
                                                <span class="iconfont icon-weibo1"><a href="#"></a></span>
                                                <span class="iconfont icon-qq"><a href="#"></a></span>
                                                <span class="iconfont icon-qqkongjian"><a href="#"></a></span>
                                            </p>
                                        </div>
                                        <div class="colorBox">
                                            <p>颜色 <span>黑色</span></p>
                                            <img src="${goodsInfo.goods_p1}" alt="">
                                        </div>
                                        <div class="sizeBox">
                                            <p>配件尺寸 <span>均码</span></p>
                                            <span>均码</span>
                                        </div>
                                        <div class="count">
                                            <p>数量</p>
                                            <div>
                                            <a href="javascript:;" class="reduce">-</a><span class="numbers">1</span><a href="javascript:;"
                                                class="add">+</a>
                                            </div>
                                            </div>
                                        <div class="op"><button class="buy">立即购买</button><button class="intoCart">加入购物车</button></div>
                                    </div>
                                </div>
                            </div>
                            <div class="detail"></div>
                            </div>
                        </div>
                        <div class="bboard">
                            <div class="w"><a href="">商品详情</a></div>
                            
                        </div>
                        <div class="DETAIL">
                            <div class="w">
                                <p class="allPic">
                                <img src="${goodsInfo.goods_b1}" alt="">
                                <img src="${goodsInfo.goods_b2}" alt="">
                                <img src="${goodsInfo.goods_b3}" alt="">
                                <img src="${goodsInfo.goods_b4}" alt="">
                                <img src="${goodsInfo.goods_b5}" alt="">
                                <img src="${goodsInfo.goods_b6}" alt="">
                                <img src="${goodsInfo.goods_b7}" alt="">
                                <img src="${goodsInfo.goods_b8}" alt="">
                                <img src="${goodsInfo.goods_b9}" alt="">
                                <img src="${goodsInfo.goods_b10}" alt="">
                            </p>
                            </div>
                        </div>

                        <div class="like">
                            <div class="w">
                            <h2>猜你喜欢</h2>
                            <ul>
                                <li><a href="./details?goods_id=381">
                                        <img src="../images/like-1.jpg" alt="">
                                        <p>TheNorthFace北面短袖Polo男户外舒适透气上新|5B1O</p>
                                        <span class="cont-money">¥398.00</span>
                                        <span class="cost-line">¥398.00</span>
                                    </a></li>
                                <li><a href="./details?goods_id=378">
                                        <img src="../images/like-2.jpg" alt="">
                                        <p>【山夏Tee】TheNorthFace北面短袖Polo男户外速干吸湿排汗上新|5B1P</p>
                                        <span class="cont-money">¥398.00</span>
                                        <span class="cost-line">¥398.00</span>
                                    </a></li>
                                <li><a href="./details?goods_id=230">
                                        <img src="../images/like-3.jpg" alt="">
                                        <p>TheNorthFace北面短袖T恤通用款户外舒适透气春季上新|5JZT</p>
                                        <span class="cont-money">¥348.00</span>
                                        <span class="cost-line">¥348.00</span>
                                    </a></li>
                                <li><a href="./details?goods_id=174">
                                        <img src="../images/like-4.jpg" alt="">
                                        <p>TheNorthFace北面短袖T恤情侣款户外舒爽透气春季上新|7WDX</p>
                                        <span class="cont-money">¥298.00</span>
                                        <span class="cost-line">¥298.00</span>
                                    </a></li>
                                <li><a href="./details?goods_id=173">
                                        <img src="../images/like-5.jpg" alt="">
                                        <p>TheNorthFace北面短袖T恤情侣款户外舒爽透气春季上新|7WE1</p>
                                        <span class="cont-money">¥348.00</span>
                                        <span class="cost-line">¥348.00</span>
                                    </a></li>
                            </ul>
                        </div>
                    </div> 
                            `
                            $('main').html(str);
                },
                error(err){
                    console.log(err.status);
                }
            })
          }
             //给左边大盒子对象绑定鼠标移动事件
                $('.left').mousemove(function(e){
            //获取当前蒙版层要移动的距离
            var left1=e.pageX-$('.left').offset().left-parseInt($('.mask').width()/2)
            var top1=e.pageY-$('.left').offset().top-parseInt($('.mask').height()/2)
            
            //设置蒙版层的边界条件
            var maxX=$('.left').width()-$(".mask").width()
            var maxY=$('.left').height()-$('.mask').height()
            //创建图片的移动距离
            var imgX,imgY

            //判断水平方向
            if(left1<=0){
                $('.mask').css("left","0px")
                imgX=0
            }else if(left1>=maxX){
                $('.mask').css('left',maxX+'px')
                imgX=maxX
            }else{
                $('.mask').css("left",left1+'px')
                imgX=left1
            }

            //判断垂直方向
            if(top1<=0){
                $('.mask').css("top","0px")
                imgY=0
            }else if(top1>=maxY){
                $('.mask').css("top",maxY+'px')
                imgY=maxY
            }else{
                $('.mask').css("top",top1+'px')
                imgY=top1
            }

            //让右边盒子中图片进行移动
            $('.right img').css('left',-2*imgX+'px')
            $('.right img').css("top",-2*imgY+'px')
        })
        var nowGoodsNum=1
        /*   原生写法      
        var mainn=document.querySelector('main');
        var shownum=document.getElementsByClassName('numbers')[0]
        mainn.onclick=function(e){
                var e = e||window.event;
                var target =e.target||e.srcElement;
                if(target.innerHTML=='+'){
                    goodsNum++;
                    shownum.innerText=goodsNum;
                }
            } */

        $('main').click(function(e){//e.target=>dom
            var tar=$(e.target)
            if(tar.html()=='+'){
                nowGoodsNum++
                $('.numbers').html(nowGoodsNum);
            }
            if(tar.html()=='-'){
                if(nowGoodsNum>1){
                    nowGoodsNum--
                $('.numbers').html(nowGoodsNum);
                }else{
                    
                }
            }
            if(tar.html()=='立即购买'){
                var userName=getCookie('userName')||null
                
                    if(!userName){
                        alert('您还未登录')
                        location='./HTML/login.html?rurl=${location.href}'
                    }else{
                        var cartInfo = localStorage.getItem(userName)||'[]'
                        cartInfo = eval('('+cartInfo+')');
                        if(cartInfo.length>0){//有商品
                            var bool =true;
                            
                            cartInfo.forEach(function(item,index){
                                if(item.goods_id==goodsInfo.goods_id){
                                    bool=!bool  
                                     item.goodsNum += nowGoodsNum;
                                     localStorage.setItem(userName,JSON.stringify(cartInfo))   
                                    }                               
                                })
                            if(bool){
                                    goodsInfo.goodsNum=nowGoodsNum;
                                    cartInfo.push(goodsInfo);
                                    localStorage.setItem(userName,JSON.stringify(cartInfo))
                                    
                                }

                        }else{
                            goodsInfo.goodsNum=nowGoodsNum;
                            cartInfo.push(goodsInfo);
                            localStorage.setItem(userName,JSON.stringify(cartInfo))
                            console.log(localStorage.getItem(userName))
                        }

                        /* 小购物车的渲染 */
                       
                    }
            }
        })
    </script> 
</body>

</html>